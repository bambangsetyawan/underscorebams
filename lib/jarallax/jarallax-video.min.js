/*!
 * Name    : Video Worker (wrapper for Youtube, Vimeo and Local videos)
 * Version : 1.2.1
 * Author  : _nK https://nkdev.info
 * GitHub  : https://github.com/nk-o/jarallax
 */
(function(g){function h(l){l=l||{};for(var n=1;n<arguments.length;n++){if(!arguments[n]){continue}for(var m in arguments[n]){if(arguments[n].hasOwnProperty(m)){l[m]=arguments[n][m]}}}return l}function i(){this._done=[];this._fail=[]}i.prototype={execute:function(n,l){var m=n.length;l=Array.prototype.slice.call(l);while(m--){n[m].apply(null,l)}},resolve:function(){this.execute(this._done,arguments)},reject:function(){this.execute(this._fail,arguments)},done:function(l){this._done.push(l)},fail:function(l){this._fail.push(l)}};function c(n,l,m){if(n.addEventListener){n.addEventListener(l,m)}else{n.attachEvent("on"+l,function(){m.call(n)})}}var e=(function(){var l=0;function m(o,n){var p=this;p.url=o;p.options_default={autoplay:1,loop:1,mute:1,controls:0,startTime:0,endTime:0};p.options=h({},p.options_default,n);p.videoID=p.parseURL(o);if(p.videoID){p.ID=l++;p.loadAPI();p.init()}}return m}());e.prototype.parseURL=function(m){function o(u){var t=/.*(?:youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=)([^#\&\?]*).*/;var s=u.match(t);return s&&s[1].length===11?s[1]:false}function p(u){var t=/https?:\/\/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|video\/|)(\d+)(?:$|\/|\?)/;var s=u.match(t);return s&&s[3]?s[3]:false}function n(x){var t=x.split(/,(?=mp4\:|webm\:|ogv\:|ogg\:)/);var s={};var w=0;for(var u=0;u<t.length;u++){var v=t[u].match(/^(mp4|webm|ogv|ogg)\:(.*)/);if(v&&v[1]&&v[2]){s[v[1]==="ogv"?"ogg":v[1]]=v[2];w=1}}return w?s:false}var l=o(m);var q=p(m);var r=n(m);if(l){this.type="youtube";return l}else{if(q){this.type="vimeo";return q}else{if(r){this.type="local";return r}}}return false};e.prototype.isValid=function(){return !!this.videoID};e.prototype.on=function(l,m){this.userEventsList=this.userEventsList||[];(this.userEventsList[l]||(this.userEventsList[l]=[])).push(m)};e.prototype.off=function(m,n){if(!this.userEventsList||!this.userEventsList[m]){return}if(!n){delete this.userEventsList[m]}else{for(var l=0;l<this.userEventsList[m].length;l++){if(this.userEventsList[m][l]===n){this.userEventsList[m][l]=false}}}};e.prototype.fire=function(n){var m=[].slice.call(arguments,1);if(this.userEventsList&&typeof this.userEventsList[n]!=="undefined"){for(var l in this.userEventsList[n]){if(this.userEventsList[n][l]){this.userEventsList[n][l].apply(this,m)}}}};e.prototype.play=function(m){var l=this;if(!l.player){return}if(l.type==="youtube"&&l.player.playVideo){if(typeof m!=="undefined"){l.player.seekTo(m||0)}l.player.playVideo()}if(l.type==="vimeo"){if(typeof m!=="undefined"){l.player.setCurrentTime(m)}l.player.getPaused().then(function(n){if(n){l.player.play()}})}if(l.type==="local"){if(typeof m!=="undefined"){l.player.currentTime=m}l.player.play()}};e.prototype.pause=function(){if(!this.player){return}if(this.type==="youtube"&&this.player.pauseVideo){this.player.pauseVideo()}if(this.type==="vimeo"){this.player.pause()}if(this.type==="local"){this.player.pause()}};e.prototype.getImageURL=function(q){var p=this;if(p.videoImage){q(p.videoImage);return}if(p.type==="youtube"){var o=["maxresdefault","sddefault","hqdefault","0"];var n=0;var m=new Image();m.onload=function(){if((this.naturalWidth||this.width)!==120||n===o.length-1){p.videoImage="https://img.youtube.com/vi/"+p.videoID+"/"+o[n]+".jpg";q(p.videoImage)}else{n++;this.src="https://img.youtube.com/vi/"+p.videoID+"/"+o[n]+".jpg"}};m.src="https://img.youtube.com/vi/"+p.videoID+"/"+o[n]+".jpg"}if(p.type==="vimeo"){var l=new XMLHttpRequest();l.open("GET","https://vimeo.com/api/v2/video/"+p.videoID+".json",true);l.onreadystatechange=function(){if(this.readyState===4){if(this.status>=200&&this.status<400){var r=JSON.parse(this.responseText);p.videoImage=r[0].thumbnail_large;q(p.videoImage)}else{}}};l.send();l=null}};e.prototype.getIframe=function(m){var l=this;if(l.$iframe){m(l.$iframe);return}l.onAPIready(function(){var r;if(!l.$iframe){r=document.createElement("div");r.style.display="none"}if(l.type==="youtube"){l.playerOptions={};l.playerOptions.videoId=l.videoID;l.playerOptions.playerVars={autohide:1,rel:0,autoplay:0};if(!l.options.controls){l.playerOptions.playerVars.iv_load_policy=3;l.playerOptions.playerVars.modestbranding=1;l.playerOptions.playerVars.controls=0;l.playerOptions.playerVars.showinfo=0;l.playerOptions.playerVars.disablekb=1}var u;var v;l.playerOptions.events={onReady:function(w){if(l.options.mute){w.target.mute()}if(l.options.autoplay){l.play(l.options.startTime)}l.fire("ready",w)},onStateChange:function(w){if(l.options.loop&&w.data===YT.PlayerState.ENDED){l.play(l.options.startTime)}if(!u&&w.data===YT.PlayerState.PLAYING){u=1;l.fire("started",w)}if(w.data===YT.PlayerState.PLAYING){l.fire("play",w)}if(w.data===YT.PlayerState.PAUSED){l.fire("pause",w)}if(w.data===YT.PlayerState.ENDED){l.fire("end",w)}if(l.options.endTime){if(w.data===YT.PlayerState.PLAYING){v=setInterval(function(){if(l.options.endTime&&l.player.getCurrentTime()>=l.options.endTime){if(l.options.loop){l.play(l.options.startTime)}else{l.pause()}}},150)}else{clearInterval(v)}}}};var s=!l.$iframe;if(s){var n=document.createElement("div");n.setAttribute("id",l.playerID);r.appendChild(n);document.body.appendChild(r)}l.player=l.player||new g.YT.Player(l.playerID,l.playerOptions);if(s){l.$iframe=document.getElementById(l.playerID);l.videoWidth=parseInt(l.$iframe.getAttribute("width"),10)||1280;l.videoHeight=parseInt(l.$iframe.getAttribute("height"),10)||720}}if(l.type==="vimeo"){l.playerOptions="";l.playerOptions+="player_id="+l.playerID;l.playerOptions+="&autopause=0";if(!l.options.controls){l.playerOptions+="&badge=0&byline=0&portrait=0&title=0"}l.playerOptions+="&autoplay="+(l.options.autoplay?"1":"0");l.playerOptions+="&loop="+(l.options.loop?1:0);if(!l.$iframe){l.$iframe=document.createElement("iframe");l.$iframe.setAttribute("id",l.playerID);l.$iframe.setAttribute("src","https://player.vimeo.com/video/"+l.videoID+"?"+l.playerOptions);l.$iframe.setAttribute("frameborder","0");r.appendChild(l.$iframe);document.body.appendChild(r)}l.player=l.player||new Vimeo.Player(l.$iframe);l.player.getVideoWidth().then(function(w){l.videoWidth=w||1280});l.player.getVideoHeight().then(function(w){l.videoHeight=w||720});if(l.options.startTime&&l.options.autoplay){l.player.setCurrentTime(l.options.startTime)}l.player.setVolume(l.options.mute?0:100);var t;l.player.on("timeupdate",function(w){if(!t){l.fire("started",w)}t=1;if(l.options.endTime){if(l.options.endTime&&w.seconds>=l.options.endTime){if(l.options.loop){l.play(l.options.startTime)}else{l.pause()}}}});l.player.on("play",function(w){l.fire("play",w);if(l.options.startTime&&w.seconds===0){l.play(l.options.startTime)}});l.player.on("pause",function(w){l.fire("pause",w)});l.player.on("ended",function(w){l.fire("end",w)});l.player.on("loaded",function(w){l.fire("ready",w)})}function p(w,z,x){var y=document.createElement("source");y.src=z;y.type=x;w.appendChild(y)}if(l.type==="local"){if(!l.$iframe){l.$iframe=document.createElement("video");if(l.options.mute){l.$iframe.muted=true}if(l.options.loop){l.$iframe.loop=true}l.$iframe.setAttribute("id",l.playerID);r.appendChild(l.$iframe);document.body.appendChild(r);for(var o in l.videoID){p(l.$iframe,l.videoID[o],"video/"+o)}}l.player=l.player||l.$iframe;var q;c(l.player,"playing",function(w){if(!q){l.fire("started",w)}q=1});c(l.player,"timeupdate",function(){if(l.options.endTime){if(l.options.endTime&&this.currentTime>=l.options.endTime){if(l.options.loop){l.play(l.options.startTime)}else{l.pause()}}}});c(l.player,"play",function(w){l.fire("play",w)});c(l.player,"pause",function(w){l.fire("pause",w)});c(l.player,"ended",function(w){l.fire("end",w)});c(l.player,"loadedmetadata",function(){l.videoWidth=this.videoWidth||1280;l.videoHeight=this.videoHeight||720;l.fire("ready");if(l.options.autoplay){l.play(l.options.startTime)}})}m(l.$iframe)})};e.prototype.init=function(){var l=this;l.playerID="VideoWorker-"+l.ID};var f=0;var k=0;e.prototype.loadAPI=function(){var o=this;if(f&&k){return}var n="";if(o.type==="youtube"&&!f){f=1;n="//www.youtube.com/iframe_api"}if(o.type==="vimeo"&&!k){k=1;n="//player.vimeo.com/api/player.js"}if(!n){return}if(g.location.origin==="file://"){n="http:"+n}var l=document.createElement("script");var m=document.getElementsByTagName("head")[0];l.src=n;m.appendChild(l);m=null;l=null};var j=0;var a=0;var b=new i();var d=new i();e.prototype.onAPIready=function(n){var m=this;if(m.type==="youtube"){if((typeof YT==="undefined"||YT.loaded===0)&&!j){j=1;g.onYouTubeIframeAPIReady=function(){g.onYouTubeIframeAPIReady=null;b.resolve("done");n()}}else{if(typeof YT==="object"&&YT.loaded===1){n()}else{b.done(function(){n()})}}}if(m.type==="vimeo"){if(typeof Vimeo==="undefined"&&!a){a=1;var l=setInterval(function(){if(typeof Vimeo!=="undefined"){clearInterval(l);d.resolve("done");n()}},20)}else{if(typeof Vimeo!=="undefined"){n()}else{d.done(function(){n()})}}}if(m.type==="local"){n()}};g.VideoWorker=e}(window));
/*!
 * Name    : Video Background Extension for Jarallax
 * Version : 1.0.0
 * Author  : _nK http://nkdev.info
 * GitHub  : https://github.com/nk-o/jarallax
 */
(function(){if(typeof jarallax==="undefined"){return}var a=jarallax.constructor;var b=a.prototype.init;a.prototype.init=function(){var f=this;b.apply(f);if(f.video){f.video.getIframe(function(g){var h=g.parentNode;f.css(g,{position:f.image.position,top:"0px",left:"0px",right:"0px",bottom:"0px",width:"100%",height:"100%",maxWidth:"none",maxHeight:"none",visibility:"hidden",margin:0,zIndex:-1});f.$video=g;f.image.$container.appendChild(g);h.parentNode.removeChild(h)})}};var e=a.prototype.coverImage;a.prototype.coverImage=function(){var f=this;e.apply(f);if(f.video&&f.image.$item.nodeName==="IFRAME"){f.css(f.image.$item,{height:f.image.$item.getBoundingClientRect().height+400+"px",marginTop:(-200+parseFloat(f.css(f.image.$item,"margin-top")))+"px"})}};var d=a.prototype.initImg;a.prototype.initImg=function(){var h=this;var g=d.apply(h);if(!h.options.videoSrc){h.options.videoSrc=h.$item.getAttribute("data-jarallax-video")||false}if(h.options.videoSrc){var f=new VideoWorker(h.options.videoSrc,{startTime:h.options.videoStartTime||0,endTime:h.options.videoEndTime||0});if(f.isValid()){h.image.useImgTag=true;f.on("ready",function(){var i=h.onScroll;h.onScroll=function(){i.apply(h);if(h.isVisible()){f.play()}else{f.pause()}}});f.on("started",function(){h.image.$default_item=h.image.$item;h.image.$item=h.$video;h.image.width=h.options.imgWidth=h.video.videoWidth||1280;h.image.height=h.options.imgHeight=h.video.videoHeight||720;h.coverImage();h.clipContainer();h.onScroll();if(h.image.$default_item){h.image.$default_item.style.display="none"}});h.video=f;if(f.type!=="local"){f.getImageURL(function(i){h.image.src=i;h.init()})}}if(f.type!=="local"){return false}else{if(!g){h.image.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";return true}}}return g};var c=a.prototype.destroy;a.prototype.destroy=function(){var f=this;c.apply(f)}}());