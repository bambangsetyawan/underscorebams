/*!
 * Name    : Video Worker (wrapper for Youtube, Vimeo and Local videos)
 * Version : 1.2.1
 * Author  : _nK https://nkdev.info
 * GitHub  : https://github.com/nk-o/jarallax
 */
(function(c){function d(l){l=l||{};for(var n=1;n<arguments.length;n++){if(!arguments[n]){continue}for(var m in arguments[n]){if(arguments[n].hasOwnProperty(m)){l[m]=arguments[n][m]}}}return l}function e(){this._done=[];this._fail=[]}e.prototype={execute:function(n,l){var m=n.length;l=Array.prototype.slice.call(l);while(m--){n[m].apply(null,l)}},resolve:function(){this.execute(this._done,arguments)},reject:function(){this.execute(this._fail,arguments)},done:function(l){this._done.push(l)},fail:function(l){this._fail.push(l)}};function j(n,l,m){if(n.addEventListener){n.addEventListener(l,m)}else{n.attachEvent("on"+l,function(){m.call(n)})}}var a=(function(){var l=0;function m(o,n){var p=this;p.url=o;p.options_default={autoplay:1,loop:1,mute:1,controls:0,startTime:0,endTime:0};p.options=d({},p.options_default,n);p.videoID=p.parseURL(o);if(p.videoID){p.ID=l++;p.loadAPI();p.init()}}return m}());a.prototype.parseURL=function(m){function o(u){var t=/.*(?:youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=)([^#\&\?]*).*/;var s=u.match(t);return s&&s[1].length===11?s[1]:false}function p(u){var t=/https?:\/\/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|video\/|)(\d+)(?:$|\/|\?)/;var s=u.match(t);return s&&s[3]?s[3]:false}function n(v){var x=v.split(/,(?=mp4\:|webm\:|ogv\:|ogg\:)/);var w={};var u=0;for(var s=0;s<x.length;s++){var t=x[s].match(/^(mp4|webm|ogv|ogg)\:(.*)/);if(t&&t[1]&&t[2]){w[t[1]==="ogv"?"ogg":t[1]]=t[2];u=1}}return u?w:false}var l=o(m);var q=p(m);var r=n(m);if(l){this.type="youtube";return l}else{if(q){this.type="vimeo";return q}else{if(r){this.type="local";return r}}}return false};a.prototype.isValid=function(){return !!this.videoID};a.prototype.on=function(l,m){this.userEventsList=this.userEventsList||[];(this.userEventsList[l]||(this.userEventsList[l]=[])).push(m)};a.prototype.off=function(m,n){if(!this.userEventsList||!this.userEventsList[m]){return}if(!n){delete this.userEventsList[m]}else{for(var l=0;l<this.userEventsList[m].length;l++){if(this.userEventsList[m][l]===n){this.userEventsList[m][l]=false}}}};a.prototype.fire=function(n){var m=[].slice.call(arguments,1);if(this.userEventsList&&typeof this.userEventsList[n]!=="undefined"){for(var l in this.userEventsList[n]){if(this.userEventsList[n][l]){this.userEventsList[n][l].apply(this,m)}}}};a.prototype.play=function(m){var l=this;if(!l.player){return}if(l.type==="youtube"&&l.player.playVideo){if(typeof m!=="undefined"){l.player.seekTo(m||0)}l.player.playVideo()}if(l.type==="vimeo"){if(typeof m!=="undefined"){l.player.setCurrentTime(m)}l.player.getPaused().then(function(n){if(n){l.player.play()}})}if(l.type==="local"){if(typeof m!=="undefined"){l.player.currentTime=m}l.player.play()}};a.prototype.pause=function(){if(!this.player){return}if(this.type==="youtube"&&this.player.pauseVideo){this.player.pauseVideo()}if(this.type==="vimeo"){this.player.pause()}if(this.type==="local"){this.player.pause()}};a.prototype.getImageURL=function(q){var p=this;if(p.videoImage){q(p.videoImage);return}if(p.type==="youtube"){var o=["maxresdefault","sddefault","hqdefault","0"];var n=0;var m=new Image();m.onload=function(){if((this.naturalWidth||this.width)!==120||n===o.length-1){p.videoImage="https://img.youtube.com/vi/"+p.videoID+"/"+o[n]+".jpg";q(p.videoImage)}else{n++;this.src="https://img.youtube.com/vi/"+p.videoID+"/"+o[n]+".jpg"}};m.src="https://img.youtube.com/vi/"+p.videoID+"/"+o[n]+".jpg"}if(p.type==="vimeo"){var l=new XMLHttpRequest();l.open("GET","https://vimeo.com/api/v2/video/"+p.videoID+".json",true);l.onreadystatechange=function(){if(this.readyState===4){if(this.status>=200&&this.status<400){var r=JSON.parse(this.responseText);p.videoImage=r[0].thumbnail_large;q(p.videoImage)}else{}}};l.send();l=null}};a.prototype.getIframe=function(m){var l=this;if(l.$iframe){m(l.$iframe);return}l.onAPIready(function(){var v;if(!l.$iframe){v=document.createElement("div");v.style.display="none"}if(l.type==="youtube"){l.playerOptions={};l.playerOptions.videoId=l.videoID;l.playerOptions.playerVars={autohide:1,rel:0,autoplay:0};if(!l.options.controls){l.playerOptions.playerVars.iv_load_policy=3;l.playerOptions.playerVars.modestbranding=1;l.playerOptions.playerVars.controls=0;l.playerOptions.playerVars.showinfo=0;l.playerOptions.playerVars.disablekb=1}var p;var q;l.playerOptions.events={onReady:function(w){if(l.options.mute){w.target.mute()}if(l.options.autoplay){l.play(l.options.startTime)}l.fire("ready",w)},onStateChange:function(w){if(l.options.loop&&w.data===YT.PlayerState.ENDED){l.play(l.options.startTime)}if(!p&&w.data===YT.PlayerState.PLAYING){p=1;l.fire("started",w)}if(w.data===YT.PlayerState.PLAYING){l.fire("play",w)}if(w.data===YT.PlayerState.PAUSED){l.fire("pause",w)}if(w.data===YT.PlayerState.ENDED){l.fire("end",w)}if(l.options.endTime){if(w.data===YT.PlayerState.PLAYING){q=setInterval(function(){if(l.options.endTime&&l.player.getCurrentTime()>=l.options.endTime){if(l.options.loop){l.play(l.options.startTime)}else{l.pause()}}},150)}else{clearInterval(q)}}}};var n=!l.$iframe;if(n){var r=document.createElement("div");r.setAttribute("id",l.playerID);v.appendChild(r);document.body.appendChild(v)}l.player=l.player||new c.YT.Player(l.playerID,l.playerOptions);if(n){l.$iframe=document.getElementById(l.playerID);l.videoWidth=parseInt(l.$iframe.getAttribute("width"),10)||1280;l.videoHeight=parseInt(l.$iframe.getAttribute("height"),10)||720}}if(l.type==="vimeo"){l.playerOptions="";l.playerOptions+="player_id="+l.playerID;l.playerOptions+="&autopause=0";if(!l.options.controls){l.playerOptions+="&badge=0&byline=0&portrait=0&title=0"}l.playerOptions+="&autoplay="+(l.options.autoplay?"1":"0");l.playerOptions+="&loop="+(l.options.loop?1:0);if(!l.$iframe){l.$iframe=document.createElement("iframe");l.$iframe.setAttribute("id",l.playerID);l.$iframe.setAttribute("src","https://player.vimeo.com/video/"+l.videoID+"?"+l.playerOptions);l.$iframe.setAttribute("frameborder","0");v.appendChild(l.$iframe);document.body.appendChild(v)}l.player=l.player||new Vimeo.Player(l.$iframe);l.player.getVideoWidth().then(function(w){l.videoWidth=w||1280});l.player.getVideoHeight().then(function(w){l.videoHeight=w||720});if(l.options.startTime&&l.options.autoplay){l.player.setCurrentTime(l.options.startTime)}l.player.setVolume(l.options.mute?0:100);var o;l.player.on("timeupdate",function(w){if(!o){l.fire("started",w)}o=1;if(l.options.endTime){if(l.options.endTime&&w.seconds>=l.options.endTime){if(l.options.loop){l.play(l.options.startTime)}else{l.pause()}}}});l.player.on("play",function(w){l.fire("play",w);if(l.options.startTime&&w.seconds===0){l.play(l.options.startTime)}});l.player.on("pause",function(w){l.fire("pause",w)});l.player.on("ended",function(w){l.fire("end",w)});l.player.on("loaded",function(w){l.fire("ready",w)})}function t(z,y,w){var x=document.createElement("source");x.src=y;x.type=w;z.appendChild(x)}if(l.type==="local"){if(!l.$iframe){l.$iframe=document.createElement("video");if(l.options.mute){l.$iframe.muted=true}if(l.options.loop){l.$iframe.loop=true}l.$iframe.setAttribute("id",l.playerID);v.appendChild(l.$iframe);document.body.appendChild(v);for(var s in l.videoID){t(l.$iframe,l.videoID[s],"video/"+s)}}l.player=l.player||l.$iframe;var u;j(l.player,"playing",function(w){if(!u){l.fire("started",w)}u=1});j(l.player,"timeupdate",function(){if(l.options.endTime){if(l.options.endTime&&this.currentTime>=l.options.endTime){if(l.options.loop){l.play(l.options.startTime)}else{l.pause()}}}});j(l.player,"play",function(w){l.fire("play",w)});j(l.player,"pause",function(w){l.fire("pause",w)});j(l.player,"ended",function(w){l.fire("end",w)});j(l.player,"loadedmetadata",function(){l.videoWidth=this.videoWidth||1280;l.videoHeight=this.videoHeight||720;l.fire("ready");if(l.options.autoplay){l.play(l.options.startTime)}})}m(l.$iframe)})};a.prototype.init=function(){var l=this;l.playerID="VideoWorker-"+l.ID};var b=0;var g=0;a.prototype.loadAPI=function(){var o=this;if(b&&g){return}var n="";if(o.type==="youtube"&&!b){b=1;n="//www.youtube.com/iframe_api"}if(o.type==="vimeo"&&!g){g=1;n="//player.vimeo.com/api/player.js"}if(!n){return}if(c.location.origin==="file://"){n="http:"+n}var l=document.createElement("script");var m=document.getElementsByTagName("head")[0];l.src=n;m.appendChild(l);m=null;l=null};var f=0;var h=0;var i=new e();var k=new e();a.prototype.onAPIready=function(n){var m=this;if(m.type==="youtube"){if((typeof YT==="undefined"||YT.loaded===0)&&!f){f=1;c.onYouTubeIframeAPIReady=function(){c.onYouTubeIframeAPIReady=null;i.resolve("done");n()}}else{if(typeof YT==="object"&&YT.loaded===1){n()}else{i.done(function(){n()})}}}if(m.type==="vimeo"){if(typeof Vimeo==="undefined"&&!h){h=1;var l=setInterval(function(){if(typeof Vimeo!=="undefined"){clearInterval(l);k.resolve("done");n()}},20)}else{if(typeof Vimeo!=="undefined"){n()}else{k.done(function(){n()})}}}if(m.type==="local"){n()}};c.VideoWorker=a}(window));
/*!
 * Name    : Video Background Extension for Jarallax
 * Version : 1.0.0
 * Author  : _nK http://nkdev.info
 * GitHub  : https://github.com/nk-o/jarallax
 */
(function(){if(typeof jarallax==="undefined"){return}var d=jarallax.constructor;var e=d.prototype.init;d.prototype.init=function(){var f=this;e.apply(f);if(f.video){f.video.getIframe(function(h){var g=h.parentNode;f.css(h,{position:f.image.position,top:"0px",left:"0px",right:"0px",bottom:"0px",width:"100%",height:"100%",maxWidth:"none",maxHeight:"none",visibility:"hidden",margin:0,zIndex:-1});f.$video=h;f.image.$container.appendChild(h);g.parentNode.removeChild(g)})}};var c=d.prototype.coverImage;d.prototype.coverImage=function(){var f=this;c.apply(f);if(f.video&&f.image.$item.nodeName==="IFRAME"){f.css(f.image.$item,{height:f.image.$item.getBoundingClientRect().height+400+"px",marginTop:(-200+parseFloat(f.css(f.image.$item,"margin-top")))+"px"})}};var b=d.prototype.initImg;d.prototype.initImg=function(){var g=this;var f=b.apply(g);if(!g.options.videoSrc){g.options.videoSrc=g.$item.getAttribute("data-jarallax-video")||false}if(g.options.videoSrc){var h=new VideoWorker(g.options.videoSrc,{startTime:g.options.videoStartTime||0,endTime:g.options.videoEndTime||0});if(h.isValid()){g.image.useImgTag=true;h.on("ready",function(){var i=g.onScroll;g.onScroll=function(){i.apply(g);if(g.isVisible()){h.play()}else{h.pause()}}});h.on("started",function(){g.image.$default_item=g.image.$item;g.image.$item=g.$video;g.image.width=g.options.imgWidth=g.video.videoWidth||1280;g.image.height=g.options.imgHeight=g.video.videoHeight||720;g.coverImage();g.clipContainer();g.onScroll();if(g.image.$default_item){g.image.$default_item.style.display="none"}});g.video=h;if(h.type!=="local"){h.getImageURL(function(i){g.image.src=i;g.init()})}}if(h.type!=="local"){return false}else{if(!f){g.image.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";return true}}}return f};var a=d.prototype.destroy;d.prototype.destroy=function(){var f=this;a.apply(f)}}());