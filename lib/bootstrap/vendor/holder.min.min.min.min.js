/*!

Holder - client side image placeholders
Version 2.9.4+cabil
Â© 2016 Ivan Malopinsky - http://imsky.co

Site:     http://holderjs.com
Issues:   https://github.com/imsky/holder/issues
License:  MIT

*/
;!function(b){if(b.document){var a=b.document;a.querySelectorAll||(a.querySelectorAll=function(d){var f,e=a.createElement("style"),c=[];for(a.documentElement.firstChild.appendChild(e),a._qsa=[],e.styleSheet.cssText=d+"{x-qsa:expression(document._qsa && document._qsa.push(this))}",b.scrollBy(0,0),e.parentNode.removeChild(e);a._qsa.length;){f=a._qsa.shift(),f.style.removeAttribute("x-qsa"),c.push(f)}return a._qsa=null,c}),a.querySelector||(a.querySelector=function(c){var d=a.querySelectorAll(c);return d.length?d[0]:null}),a.getElementsByClassName||(a.getElementsByClassName=function(c){return c=String(c).replace(/^|\s+/g,"."),a.querySelectorAll(c)}),Object.keys||(Object.keys=function(c){if(c!==Object(c)){throw TypeError("Object.keys called on non-object")}var f,d=[];for(f in c){Object.prototype.hasOwnProperty.call(c,f)&&d.push(f)}return d}),Array.prototype.forEach||(Array.prototype.forEach=function(c){if(void 0===this||null===this){throw TypeError()}var g=Object(this),d=g.length>>>0;if("function"!=typeof c){throw TypeError()}var h,f=arguments[1];for(h=0;h<d;h++){h in g&&c.call(f,g[h],h,g)}}),function(d){var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";d.atob=d.atob||function(f){f=String(f);var j,l=0,k=[],g=0,h=0;if(f=f.replace(/\s/g,""),f.length%4===0&&(f=f.replace(/=+$/,"")),f.length%4===1){throw Error("InvalidCharacterError")}if(/[^+\/0-9A-Za-z]/.test(f)){throw Error("InvalidCharacterError")}for(;l<f.length;){j=c.indexOf(f.charAt(l)),g=g<<6|j,h+=6,24===h&&(k.push(String.fromCharCode(g>>16&255)),k.push(String.fromCharCode(g>>8&255)),k.push(String.fromCharCode(255&g)),h=0,g=0),l+=1}return 12===h?(g>>=4,k.push(String.fromCharCode(255&g))):18===h&&(g>>=2,k.push(String.fromCharCode(g>>8&255)),k.push(String.fromCharCode(255&g))),k.join("")},d.btoa=d.btoa||function(q){q=String(q);var j,f,m,g,t,w,k,p=0,v=[];if(/[^\x00-\xFF]/.test(q)){throw Error("InvalidCharacterError")}for(;p<q.length;){j=q.charCodeAt(p++),f=q.charCodeAt(p++),m=q.charCodeAt(p++),g=j>>2,t=(3&j)<<4|f>>4,w=(15&f)<<2|m>>6,k=63&m,p===q.length+2?(w=64,k=64):p===q.length+1&&(k=64),v.push(c.charAt(g),c.charAt(t),c.charAt(w),c.charAt(k))}return v.join("")}}(b),Object.prototype.hasOwnProperty||(Object.prototype.hasOwnProperty=function(d){var c=this.__proto__||this.constructor.prototype;return d in this&&(!(d in c)||c[d]!==this[d])}),function(){if("performance" in b==!1&&(b.performance={}),Date.now=Date.now||function(){return(new Date).getTime()},"now" in b.performance==!1){var c=Date.now();performance.timing&&performance.timing.navigationStart&&(c=performance.timing.navigationStart),b.performance.now=function(){return Date.now()-c}}}(),b.requestAnimationFrame||(b.webkitRequestAnimationFrame&&b.webkitCancelAnimationFrame?!function(c){c.requestAnimationFrame=function(d){return webkitRequestAnimationFrame(function(){d(c.performance.now())})},c.cancelAnimationFrame=c.webkitCancelAnimationFrame}(b):b.mozRequestAnimationFrame&&b.mozCancelAnimationFrame?!function(c){c.requestAnimationFrame=function(d){return mozRequestAnimationFrame(function(){d(c.performance.now())})},c.cancelAnimationFrame=c.mozCancelAnimationFrame}(b):!function(c){c.requestAnimationFrame=function(d){return c.setTimeout(d,1000/60)},c.cancelAnimationFrame=c.clearTimeout}(b))}}(this),function(b,a){"object"==typeof exports&&"object"==typeof module?module.exports=a():"function"==typeof define&&define.amd?define([],a):"object"==typeof exports?exports.Holder=a():b.Holder=a()}(this,function(){return function(c){function b(e){if(a[e]){return a[e].exports}var d=a[e]={exports:{},id:e,loaded:!1};return c[e].call(d.exports,d,d.exports,b),d.loaded=!0,d.exports}var a={};return b.m=c,b.c=a,b.p="",b(0)}([function(c,b,a){c.exports=a(1)},function(c,b,a){(function(W){function aa(i,h,k,j){var g=d(k.substr(k.lastIndexOf(i.domain)),i);g&&ag({mode:null,el:j,flags:g,engineSettings:h})}function d(i,m){var s={theme:af(B.settings.themes.gray,null),stylesheets:m.stylesheets,instanceOptions:m},p=i.indexOf("?"),h=[i];p!==-1&&(h=[i.slice(0,p),i.slice(p+1)]);var r=h[0].split("/");s.holderURL=i;var k=r[1],o=k.match(/([\d]+p?)x([\d]+p?)/);if(!o){return !1}if(s.fluid=k.indexOf("p")!==-1,s.dimensions={width:o[1].replace("p","%"),height:o[2].replace("p","%")},2===h.length){var t=M.parse(h[1]);if(L.truthy(t.ratio)){s.fluid=!0;var g=parseFloat(s.dimensions.width.replace("%","")),l=parseFloat(s.dimensions.height.replace("%",""));l=Math.floor(100*(l/g)),g=100,s.dimensions.width=g+"%",s.dimensions.height=l+"%"}if(s.auto=L.truthy(t.auto),t.bg&&(s.theme.bg=L.parseColor(t.bg)),t.fg&&(s.theme.fg=L.parseColor(t.fg)),t.bg&&!t.fg&&(s.autoFg=!0),t.theme&&s.instanceOptions.themes.hasOwnProperty(t.theme)&&(s.theme=af(s.instanceOptions.themes[t.theme],null)),t.text&&(s.text=t.text),t.textmode&&(s.textmode=t.textmode),t.size&&(s.size=t.size),t.font&&(s.font=t.font),t.align&&(s.align=t.align),t.lineWrap&&(s.lineWrap=t.lineWrap),s.nowrap=L.truthy(t.nowrap),s.outline=L.truthy(t.outline),L.truthy(t.random)){B.vars.cache.themeKeys=B.vars.cache.themeKeys||Object.keys(s.instanceOptions.themes);var j=B.vars.cache.themeKeys[0|Math.random()*B.vars.cache.themeKeys.length];s.theme=af(s.instanceOptions.themes[j],null)}}return s}function ag(j){var r=j.mode,l=j.el,u=j.flags,p=j.engineSettings,x=u.dimensions,s=u.theme,o=x.width+"x"+x.height;r=null==r?u.fluid?"fluid":"image":r;var k=/holder_([a-z]+)/g,i=!1;if(null!=u.text&&(s.text=u.text,"object"===l.nodeName.toLowerCase())){for(var g=s.text.split("\\n"),v=0;v<g.length;v++){g[v]=L.encodeHtmlEntity(g[v])}s.text=g.join("\\n")}if(s.text){var h=s.text.match(k);null!==h&&h.forEach(function(z){"holder_dimensions"===z&&(s.text=s.text.replace(z,o))})}var m=u.holderURL,y=af(p,null);if(u.font&&(s.font=u.font,!y.noFontFallback&&"img"===l.nodeName.toLowerCase()&&B.setup.supportsCanvas&&"svg"===y.renderer&&(y=af(y,{renderer:"canvas"}))),u.font&&"canvas"==y.renderer&&(y.reRender=!0),"background"==r){null==l.getAttribute("data-background-src")&&I.setAttr(l,{"data-background-src":m})}else{var w={};w[B.vars.dataAttr]=m,I.setAttr(l,w)}u.theme=s,l.holderData={flags:u,engineSettings:y},"image"!=r&&"fluid"!=r||I.setAttr(l,{alt:s.text?i?s.text:s.text+" ["+o+"]":o});var t={mode:r,el:l,holderSettings:{dimensions:x,theme:s,flags:u},engineSettings:y};"image"==r?(u.auto||(l.style.width=x.width+"px",l.style.height=x.height+"px"),"html"==y.renderer?l.style.backgroundColor=s.bg:(n(t),"exact"==u.textmode&&(l.holderData.resizeUpdate=!0,B.vars.resizableImages.push(l),e(l)))):"background"==r&&"html"!=y.renderer?n(t):"fluid"==r&&(l.holderData.resizeUpdate=!0,"%"==x.height.slice(-1)?l.style.height=x.height:null!=u.auto&&u.auto||(l.style.height=x.height+"px"),"%"==x.width.slice(-1)?l.style.width=x.width:null!=u.auto&&u.auto||(l.style.width=x.width+"px"),"inline"!=l.style.display&&""!==l.style.display&&"none"!=l.style.display||(l.style.display="block"),U(l),"html"==y.renderer?l.style.backgroundColor=s.bg:(B.vars.resizableImages.push(l),e(l)))}function n(i){function o(){var r=null;switch(p.renderer){case"canvas":r=V(k,i);break;case"svg":r=Z(k,i);break;default:throw"Holder: invalid renderer: "+p.renderer}return r}var l=null,h=i.mode,m=i.el,j=i.holderSettings,p=i.engineSettings;switch(p.renderer){case"svg":if(!B.setup.supportsSVG){return}break;case"canvas":if(!B.setup.supportsCanvas){return}break;default:return}var g={width:j.dimensions.width,height:j.dimensions.height,theme:j.theme,flags:j.flags},k=Y(g);if(l=o(),null==l){throw"Holder: couldn't render placeholder"}"background"==h?(m.style.backgroundImage="url("+l+")",p.noBackgroundSize||(m.style.backgroundSize=g.width+"px "+g.height+"px")):("img"===m.nodeName.toLowerCase()?I.setAttr(m,{src:l}):"object"===m.nodeName.toLowerCase()&&I.setAttr(m,{data:l,type:"image/svg+xml"}),p.reRender&&W.setTimeout(function(){var r=o();if(null==r){throw"Holder: couldn't render placeholder"}"img"===m.nodeName.toLowerCase()?I.setAttr(m,{src:r}):"object"===m.nodeName.toLowerCase()&&I.setAttr(m,{data:r,type:"image/svg+xml"})},150)),I.setAttr(m,{"data-holder-rendered":!0})}function Y(v){function A(T,ad,ac,al){ad.width=ac,ad.height=al,T.width=Math.max(T.width,ad.width),T.height+=ad.height}var i=B.defaults.size;switch(parseFloat(v.theme.size)?i=v.theme.size:parseFloat(v.flags.size)&&(i=v.flags.size),v.font={family:v.theme.font?v.theme.font:"Arial, Helvetica, Open Sans, sans-serif",size:aj(v.width,v.height,i,B.defaults.scale),units:v.theme.units?v.theme.units:B.defaults.units,weight:v.theme.fontweight?v.theme.fontweight:"bold"},v.text=v.theme.text||Math.floor(v.width)+"x"+Math.floor(v.height),v.noWrap=v.theme.nowrap||v.flags.nowrap,v.align=v.theme.align||v.flags.align||"center",v.flags.textmode){case"literal":v.text=v.flags.dimensions.width+"x"+v.flags.dimensions.height;break;case"exact":if(!v.flags.exactDimensions){break}v.text=Math.floor(v.flags.exactDimensions.width)+"x"+Math.floor(v.flags.exactDimensions.height)}var F=v.flags.lineWrap||B.setup.lineWrapRatio,p=v.width*F,h=p,l=new H({width:v.width,height:v.height}),C=l.Shape,r=new C.Rect("holderBg",{fill:v.theme.bg});if(r.resize(v.width,v.height),l.root.add(r),v.flags.outline){var o=new q(r.properties.fill);o=o.lighten(o.lighterThan("7f7f7f")?-0.1:0.1),r.properties.outline={fill:o.toHex(!0),width:2}}var x=v.theme.fg;if(v.flags.autoFg){var w=new q(r.properties.fill),u=new q("fff"),g=new q("000",{alpha:0.285714});x=w.blendAlpha(w.lighterThan("7f7f7f")?g:u).toHex(!0)}var s=new C.Group("holderTextGroup",{text:v.text,align:v.align,font:v.font,fill:x});s.moveTo(null,null,1),l.root.add(s);var k=s.textPositionData=G(l);if(!k){throw"Holder: staging fallback not supported yet."}s.properties.leading=k.boundingBox.height;var z=null,y=null;if(k.lineCount>1){var j,O=0,S=0,D=0;y=new C.Group("line"+D),"left"!==v.align&&"right"!==v.align||(h=v.width*(1-2*(1-F)));for(var t=0;t<k.words.length;t++){var m=k.words[t];z=new C.Text(m.text);var E="\\n"==m.text;!v.noWrap&&(O+m.width>=h||E===!0)&&(A(s,y,O,s.properties.leading),s.add(y),O=0,S+=s.properties.leading,D+=1,y=new C.Group("line"+D),y.y=S),E!==!0&&(z.moveTo(O,0),O+=k.spaceWidth+m.width,y.add(z))}if(A(s,y,O,s.properties.leading),s.add(y),"left"===v.align){s.moveTo(v.width-p,null,null)}else{if("right"===v.align){for(j in s.children){y=s.children[j],y.moveTo(v.width-y.width,null,null)}s.moveTo(0-(v.width-p),null,null)}else{for(j in s.children){y=s.children[j],y.moveTo((s.width-y.width)/2,null,null)}s.moveTo((v.width-s.width)/2,null,null)}}s.moveTo(null,(v.height-s.height)/2,null),(v.height-s.height)/2<0&&s.moveTo(null,0,null)}else{z=new C.Text(v.text),y=new C.Group("line0"),y.add(z),s.add(y),"left"===v.align?s.moveTo(v.width-p,null,null):"right"===v.align?s.moveTo(0-(v.width-p),null,null):s.moveTo((v.width-k.boundingBox.width)/2,null,null),s.moveTo(null,(v.height-k.boundingBox.height)/2,null)}return l}function aj(h,i,m,k){var p=parseInt(h,10),l=parseInt(i,10),g=Math.max(p,l),j=Math.min(p,l),o=0.8*Math.min(j,g*k);return Math.round(Math.max(m,o))}function e(i){var j;j=null==i||null==i.nodeType?B.vars.resizableImages:[i];for(var o=0,l=j.length;o<l;o++){var h=j[o];if(h.holderData){var m=h.holderData.flags,k=K(h);if(k){if(!h.holderData.resizeUpdate){continue}if(m.fluid&&m.auto){var p=h.holderData.fluidConfig;switch(p.mode){case"width":k.height=k.width/p.ratio;break;case"height":k.width=k.height*p.ratio}}var g={mode:"image",holderSettings:{dimensions:k,theme:m.theme,flags:m},el:h,engineSettings:h.holderData.engineSettings};"exact"==m.textmode&&(m.exactDimensions=k,g.holderSettings.dimensions=m.dimensions),n(g)}else{J(h)}}}}function U(h){if(h.holderData){var g=K(h);if(g){var j=h.holderData.flags,i={fluidHeight:"%"==j.dimensions.height.slice(-1),fluidWidth:"%"==j.dimensions.width.slice(-1),mode:null,initialDimensions:g};i.fluidWidth&&!i.fluidHeight?(i.mode="width",i.ratio=i.initialDimensions.width/parseFloat(j.dimensions.height)):!i.fluidWidth&&i.fluidHeight&&(i.mode="height",i.ratio=parseFloat(j.dimensions.width)/i.initialDimensions.height),h.holderData.fluidConfig=i}else{J(h)}}}function Q(){var g,i=[],h=Object.keys(B.vars.invisibleImages);h.forEach(function(j){g=B.vars.invisibleImages[j],K(g)&&"img"==g.nodeName.toLowerCase()&&(i.push(g),delete B.vars.invisibleImages[j])}),i.length&&P.run({images:i}),setTimeout(function(){W.requestAnimationFrame(Q)},10)}function N(){B.vars.visibilityCheckStarted||(W.requestAnimationFrame(Q),B.vars.visibilityCheckStarted=!0)}function J(g){g.holderData.invisibleId||(B.vars.invisibleId+=1,B.vars.invisibleImages["i"+B.vars.invisibleId]=g,g.holderData.invisibleId=B.vars.invisibleId)}function ae(g){B.vars.debounceTimer||g.call(this),B.vars.debounceTimer&&W.clearTimeout(B.vars.debounceTimer),B.vars.debounceTimer=W.setTimeout(function(){B.vars.debounceTimer=null,g.call(this)},B.setup.debounce)}function f(){ae(function(){e(null)})}var ai=a(2),M=a(3),H=a(6),L=a(7),R=a(8),I=a(9),q=a(10),ab=a(11),Z=a(12),V=a(15),af=L.extend,K=L.dimensionCheck,ah=ab.svg_ns,P={version:ab.version,addTheme:function(h,g){return null!=h&&null!=g&&(B.settings.themes[h]=g),delete B.vars.cache.themeKeys,this},addImage:function(g,i){var h=I.getNodeArray(i);return h.forEach(function(j){var l=I.newEl("img"),k={};k[B.setup.dataAttr]=g,I.setAttr(l,k),j.appendChild(l)}),this},setResizeUpdate:function(h,g){h.holderData&&(h.holderData.resizeUpdate=!!g,h.holderData.resizeUpdate&&e(h))},run:function(k){k=k||{};var m={},h=af(B.settings,k);B.vars.preempted=!0,B.vars.dataAttr=h.dataAttr||B.setup.dataAttr,m.renderer=h.renderer?h.renderer:B.setup.renderer,B.setup.renderers.join(",").indexOf(m.renderer)===-1&&(m.renderer=B.setup.supportsSVG?"svg":B.setup.supportsCanvas?"canvas":"html");var l=I.getNodeArray(h.images),g=I.getNodeArray(h.bgnodes),j=I.getNodeArray(h.stylenodes),i=I.getNodeArray(h.objects);return m.stylesheets=[],m.svgXMLStylesheet=!0,m.noFontFallback=!!h.noFontFallback,m.noBackgroundSize=!!h.noBackgroundSize,j.forEach(function(s){if(s.attributes.rel&&s.attributes.href&&"stylesheet"==s.attributes.rel.value){var p=s.attributes.href.value,r=I.newEl("a");r.href=p;var o=r.protocol+"//"+r.host+r.pathname+r.search;m.stylesheets.push(o)}}),g.forEach(function(r){if(W.getComputedStyle){var w=W.getComputedStyle(r,null).getPropertyValue("background-image"),v=r.getAttribute("data-background-src"),x=v||w,o=null,u=h.domain+"/",t=x.indexOf(u);if(0===t){o=x}else{if(1===t&&"?"===x[0]){o=x.slice(1)}else{var s=x.substr(t).match(/([^\"]*)"?\)/);if(null!==s){o=s[1]}else{if(0===x.indexOf("url(")){throw"Holder: unable to parse background URL: "+x}}}}if(o){var p=d(o,h);p&&ag({mode:"background",el:r,flags:p,engineSettings:m})}}}),i.forEach(function(s){var p={};try{p.data=s.getAttribute("data"),p.dataSrc=s.getAttribute(B.vars.dataAttr)}catch(t){}var o=null!=p.data&&0===p.data.indexOf(h.domain),r=null!=p.dataSrc&&0===p.dataSrc.indexOf(h.domain);o?aa(h,m,p.data,s):r&&aa(h,m,p.dataSrc,s)}),l.forEach(function(o){var s={};try{s.src=o.getAttribute("src"),s.dataSrc=o.getAttribute(B.vars.dataAttr),s.rendered=o.getAttribute("data-holder-rendered")}catch(r){}var p=null!=s.src,u=null!=s.dataSrc&&0===s.dataSrc.indexOf(h.domain),t=null!=s.rendered&&"true"==s.rendered;p?0===s.src.indexOf(h.domain)?aa(h,m,s.src,o):u&&(t?aa(h,m,s.dataSrc,o):!function(y,w,v,x,z){L.imageExists(y,function(A){A||aa(w,v,x,z)})}(s.src,h,m,s.dataSrc,o)):u&&aa(h,m,s.dataSrc,o)}),this}},B={settings:{domain:"holder.js",images:"img",objects:"object",bgnodes:"body .holderjs",stylenodes:"head link.holderjs",themes:{gray:{bg:"#EEEEEE",fg:"#AAAAAA"},social:{bg:"#3a5a97",fg:"#FFFFFF"},industrial:{bg:"#434A52",fg:"#C2F200"},sky:{bg:"#0D8FDB",fg:"#FFFFFF"},vine:{bg:"#39DBAC",fg:"#1E292C"},lava:{bg:"#F8591A",fg:"#1C2846"}}},defaults:{size:10,units:"pt",scale:1/16}},G=function(){var g=null,i=null,h=null;return function(u){var p=u.root;if(B.setup.supportsSVG){var k=!1,v=function(C){return document.createTextNode(C)};null!=g&&g.parentNode===document.body||(k=!0),g=R.initSVG(g,p.properties.width,p.properties.height),g.style.display="block",k&&(i=I.newEl("text",ah),h=v(null),I.setAttr(i,{x:0}),i.appendChild(h),g.appendChild(i),document.body.appendChild(g),g.style.visibility="hidden",g.style.position="absolute",g.style.top="-100%",g.style.left="-100%");var s=p.children.holderTextGroup,o=s.properties;I.setAttr(i,{y:o.font.size,style:L.cssProps({"font-weight":o.font.weight,"font-size":o.font.size+o.font.units,"font-family":o.font.family})}),h.nodeValue=o.text;var y=i.getBBox(),r=Math.ceil(y.width/p.properties.width),l=o.text.split(" "),j=o.text.match(/\\n/g);r+=null==j?0:j.length,h.nodeValue=o.text.replace(/[ ]+/g,"");var A=i.getComputedTextLength(),w=y.width-A,z=Math.round(w/Math.max(1,l.length-1)),m=[];if(r>1){h.nodeValue="";for(var x=0;x<l.length;x++){if(0!==l[x].length){h.nodeValue=L.decodeHtmlEntity(l[x]);var t=i.getBBox();m.push({text:l[x],width:t.width})}}}return g.style.display="none",{spaceWidth:z,lineCount:r,boundingBox:y,words:m}}return !1}}();for(var X in B.flags){B.flags.hasOwnProperty(X)&&(B.flags[X].match=function(g){return g.match(this.regex)})}B.setup={renderer:"html",debounce:100,ratio:1,supportsCanvas:!1,supportsSVG:!1,lineWrapRatio:0.9,dataAttr:"data-src",renderers:["html","canvas","svg"]},B.vars={preempted:!1,resizableImages:[],invisibleImages:{},invisibleId:0,visibilityCheckStarted:!1,debounceTimer:null,cache:{}},function(){var g=I.newEl("canvas");g.getContext&&g.toDataURL("image/png").indexOf("data:image/png")!=-1&&(B.setup.renderer="canvas",B.setup.supportsCanvas=!0),document.createElementNS&&document.createElementNS(ah,"svg").createSVGRect&&(B.setup.renderer="svg",B.setup.supportsSVG=!0)}(),N(),ai&&ai(function(){B.vars.preempted||P.run(),W.addEventListener?(W.addEventListener("resize",f,!1),W.addEventListener("orientationchange",f,!1)):W.attachEvent("onresize",f),"object"==typeof W.Turbolinks&&W.document.addEventListener("page:change",function(){P.run()})}),c.exports=P}).call(b,function(){return this}())},function(c,b){function a(O){function I(g){if(!d){if(!V.body){return K(I)}for(d=!0;g=R.shift();){K(g)}}}function G(g){(k||g.type===J||V[P]===Q)&&(j(),I())}function j(){k?(V[U](H,G,L),O[U](J,G,L)):(V[B](W,G),O[B](z,G))}function K(h,g){setTimeout(h,+g>=0?g:1)}function D(g){d?K(g):R.push(g)}null==document.readyState&&document.addEventListener&&(document.addEventListener("DOMContentLoaded",function f(){document.removeEventListener("DOMContentLoaded",f,!1),document.readyState="complete"},!1),document.readyState="loading");var V=O.document,e=V.documentElement,J="load",L=!1,z="on"+J,Q="complete",P="readyState",N="attachEvent",B="detachEvent",M="addEventListener",H="DOMContentLoaded",W="onreadystatechange",U="removeEventListener",k=M in V,T=L,d=L,R=[];if(V[P]===Q){K(I)}else{if(k){V[M](H,G,L),O[M](J,G,L)}else{V[N](W,G),O[N](z,G);try{T=null==O.frameElement&&e}catch(q){}T&&T.doScroll&&!function F(){if(!d){try{T.doScroll("left")}catch(g){return K(F,50)}j(),I()}}()}}return D.version="1.4.0",D.isReady=function(){return d},D}c.exports="undefined"!=typeof window&&a(window)},function(h,k,d){var b=encodeURIComponent,g=decodeURIComponent,c=d(4),j=d(5),m=/(\w+)\[(\d+)\]/,f=/\w+\.\w+/;k.parse=function(q){if("string"!=typeof q){return{}}if(q=c(q),""===q){return{}}"?"===q.charAt(0)&&(q=q.slice(1));for(var l={},o=q.split("&"),n=0;n<o.length;n++){var e,p,i,a=o[n].split("="),r=g(a[0]);if(e=m.exec(r)){l[e[1]]=l[e[1]]||[],l[e[1]][e[2]]=g(a[1])}else{if(e=f.test(r)){for(e=r.split("."),p=l;e.length;){if(i=e.shift(),i.length){if(p[i]){if(p[i]&&"object"!=typeof p[i]){break}}else{p[i]={}}e.length||(p[i]=g(a[1])),p=p[i]}}}else{l[a[0]]=null==a[1]?"":g(a[1])}}}return l},k.stringify=function(e){if(!e){return""}var n=[];for(var l in e){var a=e[l];if("array"!=j(a)){n.push(b(l)+"="+b(e[l]))}else{for(var i=0;i<a.length;++i){n.push(b(l+"["+i+"]")+"="+b(a[i]))}}}return n.join("&")}},function(c,b){function a(d){return d.replace(/^\s*|\s*$/g,"")}b=c.exports=a,b.left=function(d){return d.replace(/^\s*/,"")},b.right=function(d){return d.replace(/\s*$/,"")}},function(a,c){function b(e){return !(null==e||!(e._isBuffer||e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)))}var d=Object.prototype.toString;a.exports=function(e){switch(d.call(e)){case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array";case"[object Error]":return"error"}return null===e?"null":void 0===e?"undefined":e!==e?"nan":e&&1===e.nodeType?"element":b(e)?"buffer":(e=e.valueOf?e.valueOf():Object.prototype.valueOf.apply(e),typeof e)}},function(c,b){var a=function(p){function t(i,h){for(var l in h){i[l]=h[l]}return i}var g=1,e=function(h){g++,this.parent=null,this.children={},this.id=g,this.name="n"+g,"undefined"!=typeof h&&(this.name=h),this.x=this.y=this.z=0,this.width=this.height=0};e.prototype.resize=function(i,h){null!=i&&(this.width=i),null!=h&&(this.height=h)},e.prototype.moveTo=function(i,h,l){this.x=null!=i?i:this.x,this.y=null!=h?h:this.y,this.z=null!=l?l:this.z},e.prototype.add=function(i){var h=i.name;if("undefined"!=typeof this.children[h]){throw"SceneGraph: child already exists: "+h}this.children[h]=i,i.parent=this};var k=function(){e.call(this,"root"),this.properties=p};k.prototype=new e;var f=function(h,i){if(e.call(this,h),this.properties={fill:"#000000"},"undefined"!=typeof i){t(this.properties,i)}else{if("undefined"!=typeof h&&"string"!=typeof h){throw"SceneGraph: invalid node name"}}};f.prototype=new e;var q=function(){f.apply(this,arguments),this.type="group"};q.prototype=new f;var d=function(){f.apply(this,arguments),this.type="rect"};d.prototype=new f;var j=function(h){f.call(this),this.type="text",this.properties.text=h};j.prototype=new f;var m=new k;return this.Shape={Rect:d,Text:j,Group:q},this.root=m,this};c.exports=a},function(b,a){(function(c){a.extend=function(j,g){var d={};for(var h in j){j.hasOwnProperty(h)&&(d[h]=j[h])}if(null!=g){for(var f in g){g.hasOwnProperty(f)&&(d[f]=g[f])}}return d},a.cssProps=function(g){var f=[];for(var d in g){g.hasOwnProperty(d)&&f.push(d+":"+g[d])}return f.join(";")},a.encodeHtmlEntity=function(h){for(var f=[],d=0,g=h.length-1;g>=0;g--){d=h.charCodeAt(g),d>128?f.unshift(["&#",d,";"].join("")):f.unshift(h[g])}return f.join("")},a.imageExists=function(g,f){var d=new Image;d.onerror=function(){f.call(this,!1)},d.onload=function(){f.call(this,!0)},d.src=g},a.decodeHtmlEntity=function(d){return d.replace(/&#(\d+);/g,function(g,f){return String.fromCharCode(f)})},a.dimensionCheck=function(d){var f={height:d.clientHeight,width:d.clientWidth};return !(!f.height||!f.width)&&f},a.truthy=function(d){return"string"==typeof d?"true"===d||"yes"===d||"1"===d||"on"===d||"â"===d:!!d},a.parseColor=function(h){var f,d=/(^(?:#?)[0-9a-f]{6}$)|(^(?:#?)[0-9a-f]{3}$)/i,g=/^rgb\((\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/,k=/^rgba\((\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(0\.\d{1,}|1)\)$/,j=h.match(d);return null!==j?(f=j[1]||j[2],"#"!==f[0]?"#"+f:f):(j=h.match(g),null!==j?f="rgb("+j.slice(1).join(",")+")":(j=h.match(k),null!==j?f="rgba("+j.slice(1).join(",")+")":null))},a.canvasRatio=function(){var f=1,d=1;if(c.document){var g=c.document.createElement("canvas");if(g.getContext){var e=g.getContext("2d");f=c.devicePixelRatio||1,d=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1}}return f/d}}).call(a,function(){return this}())},function(c,b,a){(function(d){var g=a(9),f="http://www.w3.org/2000/svg",e=8;b.initSVG=function(m,k,p){var i,j,q=!1;m&&m.querySelector?(j=m.querySelector("style"),null===j&&(q=!0)):(m=g.newEl("svg",f),q=!0),q&&(i=g.newEl("defs",f),j=g.newEl("style",f),g.setAttr(j,{type:"text/css"}),i.appendChild(j),m.appendChild(i)),m.webkitMatchesSelector&&m.setAttribute("xmlns",f);for(var o=0;o<m.childNodes.length;o++){m.childNodes[o].nodeType===e&&m.removeChild(m.childNodes[o])}for(;j.childNodes.length;){j.removeChild(j.childNodes[0])}return g.setAttr(m,{width:k,height:p,viewBox:"0 0 "+k+" "+p,preserveAspectRatio:"none"}),m},b.svgStringToDataURI=function(){var i="data:image/svg+xml;charset=UTF-8,",j="data:image/svg+xml;charset=UTF-8;base64,";return function(k,h){return h?j+btoa(d.unescape(encodeURIComponent(k))):i+encodeURIComponent(k)}}(),b.serializeSVG=function(q,w){if(d.XMLSerializer){var j=new XMLSerializer,v="",m=w.stylesheets;if(w.svgXMLStylesheet){for(var r=g.createXML(),i=m.length-1;i>=0;i--){var k=r.createProcessingInstruction("xml-stylesheet",'href="'+m[i]+'" rel="stylesheet"');r.insertBefore(k,r.firstChild)}r.removeChild(r.documentElement),v=j.serializeToString(r)}var p=j.serializeToString(q);return p=p.replace(/\&amp;(\#[0-9]{2,}\;)/g,"&$1"),v+p}}}).call(b,function(){return this}())},function(b,a){(function(c){a.newEl=function(e,d){if(c.document){return null==d?c.document.createElement(e):c.document.createElementNS(d,e)}},a.setAttr=function(g,f){for(var d in f){g.setAttribute(d,f[d])}},a.createXML=function(){if(c.DOMParser){return(new DOMParser).parseFromString("<xml />","application/xml")}},a.getNodeArray=function(e){var d=null;return"string"==typeof e?d=document.querySelectorAll(e):c.NodeList&&e instanceof c.NodeList?d=e:c.Node&&e instanceof c.Node?d=[e]:c.HTMLCollection&&e instanceof c.HTMLCollection?d=e:e instanceof Array?d=e:null===e&&(d=[]),d=Array.prototype.slice.call(d)}}).call(a,function(){return this}())},function(c,b){var a=function(e,d){"string"==typeof e&&(this.original=e,"#"===e.charAt(0)&&(e=e.slice(1)),/[^a-f0-9]+/i.test(e)||(3===e.length&&(e=e.replace(/./g,"$&$&")),6===e.length&&(this.alpha=1,d&&d.alpha&&(this.alpha=d.alpha),this.set(parseInt(e,16)))))};a.rgb2hex=function(d,f,e){function g(j){var i=(0|j).toString(16);return j<16&&(i="0"+i),i}return[d,f,e].map(g).join("")},a.hsl2rgb=function(p,t,g){var e=p/60,k=(1-Math.abs(2*g-1))*t,f=k*(1-Math.abs(parseInt(e)%2-1)),q=g-k/2,d=0,j=0,m=0;return e>=0&&e<1?(d=k,j=f):e>=1&&e<2?(d=f,j=k):e>=2&&e<3?(j=k,m=f):e>=3&&e<4?(j=f,m=k):e>=4&&e<5?(d=f,m=k):e>=5&&e<6&&(d=k,m=f),d+=q,j+=q,m+=q,d=parseInt(255*d),j=parseInt(255*j),m=parseInt(255*m),[d,j,m]},a.prototype.set=function(k){this.raw=k;var e=(16711680&this.raw)>>16,f=(65280&this.raw)>>8,g=255&this.raw,j=0.2126*e+0.7152*f+0.0722*g,d=-0.09991*e-0.33609*f+0.436*g,h=0.615*e-0.55861*f-0.05639*g;return this.rgb={r:e,g:f,b:g},this.yuv={y:j,u:d,v:h},this},a.prototype.lighten=function(e){var d=Math.min(1,Math.max(0,Math.abs(e)))*(e<0?-1:1),k=255*d|0,j=Math.min(255,Math.max(0,this.rgb.r+k)),f=Math.min(255,Math.max(0,this.rgb.g+k)),h=Math.min(255,Math.max(0,this.rgb.b+k)),g=a.rgb2hex(j,f,h);return new a(g)},a.prototype.toHex=function(d){return(d?"#":"")+this.raw.toString(16)},a.prototype.lighterThan=function(d){return d instanceof a||(d=new a(d)),this.yuv.y>d.yuv.y},a.prototype.blendAlpha=function(e){e instanceof a||(e=new a(e));var h=e,j=this,g=h.alpha*h.rgb.r+(1-h.alpha)*j.rgb.r,f=h.alpha*h.rgb.g+(1-h.alpha)*j.rgb.g,d=h.alpha*h.rgb.b+(1-h.alpha)*j.rgb.b;return new a(a.rgb2hex(g,f,d))},c.exports=a},function(b,a){b.exports={version:"2.9.4",svg_ns:"http://www.w3.org/2000/svg"}},function(m,w,f){function b(c,a){return p.element({tag:a,width:c.width,height:c.height,fill:c.properties.fill})}function j(a){return k.cssProps({fill:a.fill,"font-weight":a.font.weight,"font-family":a.font.family+", monospace","font-size":a.font.size+a.font.units})}function d(e,a,h){var c=h/2;return["M",c,c,"H",e-c,"V",a-c,"H",c,"V",0,"M",0,c,"L",e,a-c,"M",0,a-c,"L",e,c].join(" ")}var q=f(13),x=f(8),g=f(11),k=f(7),v=g.svg_ns,p={element:function(c){var a=c.tag,e=c.content||"";return delete c.tag,delete c.content,[a,e,c]}};m.exports=function(I,D){var o=D.engineSettings,u=o.stylesheets,F=u.map(function(y){return'<?xml-stylesheet rel="stylesheet" href="'+y+'"?>'}).join("\n"),J="holder_"+Number(new Date).toString(16),H=I.root,l=H.children.holderTextGroup,G="#"+J+" text { "+j(l.properties)+" } ";l.y+=0.8*l.textPositionData.boundingBox.height;var r=[];Object.keys(l.children).forEach(function(y){var A=l.children[y];Object.keys(A.children).forEach(function(N){var L=A.children[N],C=l.x+A.x+L.x,M=l.y+A.y+L.y,E=p.element({tag:"text",content:L.properties.text,x:C,y:M});r.push(E)})});var B=p.element({tag:"g",content:r}),e=null;if(H.children.holderBg.properties.outline){var s=H.children.holderBg.properties.outline;e=p.element({tag:"path",d:d(H.children.holderBg.width,H.children.holderBg.height,s.width),"stroke-width":s.width,stroke:s.fill,fill:"none"})}var K=b(H.children.holderBg,"rect"),h=[];h.push(K),s&&h.push(e),h.push(B);var c=p.element({tag:"g",id:J,content:h}),t=p.element({tag:"style",content:G,type:"text/css"}),i=p.element({tag:"defs",content:t}),n=p.element({tag:"svg",content:[i,c],width:H.properties.width,height:H.properties.height,xmlns:v,viewBox:[0,0,H.properties.width,H.properties.height].join(" "),preserveAspectRatio:"none"}),z=q(n);z=F+z[0];var a=x.svgStringToDataURI(z,"background"===D.mode);return a}},function(a,c,b){b(14);a.exports=function d(r,x,h){function k(t){var n=t.match(/^[\w-]+/),o={tag:n?n[0]:"div",attr:{},children:[]},i=t.match(/#([\w-]+)/),l=t.match(/\$([\w-]+)/),s=t.match(/\.[\w-]+/g);return i&&(o.attr.id=i[1],h[i[1]]=o),l&&(h[l[1]]=o),s&&(o.attr["class"]=s.join(" ").replace(/\./g,"")),t.match(/&$/g)&&(q=!1),o}function g(l,i){if(null!==i&&i!==!1&&void 0!==i){return"string"!=typeof i&&"object"!=typeof i?String(i):i}}function v(i){return i||0===i?String(i).replace(/&/g,"&amp;").replace(/"/g,"&quot;"):""}function m(i){return String(i).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var j,p,w,f,e=1,q=!0;if(h=h||{},"string"==typeof r[0]){r[0]=k(r[0])}else{if(!Array.isArray(r[0])){throw new Error("First element of array must be a string, or an array and not "+JSON.stringify(r[0]))}e=0}for(;e<r.length;e++){if(r[e]===!1||null===r[e]){r[0]=!1;break}if(void 0!==r[e]&&r[e]!==!0){if("string"==typeof r[e]){q&&(r[e]=m(r[e])),r[0].children.push(r[e])}else{if("number"==typeof r[e]){r[0].children.push(r[e])}else{if(Array.isArray(r[e])){if(Array.isArray(r[e][0])){if(r[e].reverse().forEach(function(i){r.splice(e+1,0,i)}),0!==e){continue}e++}d(r[e],x,h),r[e][0]&&r[0].children.push(r[e][0])}else{if("function"==typeof r[e]){w=r[e]}else{if("object"!=typeof r[e]){throw new TypeError('"'+r[e]+'" is not allowed as a value.')}for(p in r[e]){r[e].hasOwnProperty(p)&&null!==r[e][p]&&r[e][p]!==!1&&("style"===p&&"object"==typeof r[e][p]?r[0].attr[p]=JSON.stringify(r[e][p],g).slice(2,-2).replace(/","/g,";").replace(/":"/g,":").replace(/\\"/g,"'"):r[0].attr[p]=r[e][p])}}}}}}}if(r[0]!==!1){j="<"+r[0].tag;for(f in r[0].attr){r[0].attr.hasOwnProperty(f)&&(j+=" "+f+'="'+v(r[0].attr[f])+'"')}j+=">",r[0].children.forEach(function(i){j+=i}),j+="</"+r[0].tag+">",r[0]=j}return h[0]=r[0],w&&w(r[0]),h}},function(a,c){function b(l){var g=""+l,f=d.exec(g);if(!f){return g}var k,e="",j=0,h=0;for(j=f.index;j<g.length;j++){switch(g.charCodeAt(j)){case 34:k="&quot;";break;case 38:k="&amp;";break;case 39:k="&#39;";break;case 60:k="&lt;";break;case 62:k="&gt;";break;default:continue}h!==j&&(e+=g.substring(h,j)),h=j+1,e+=k}return h!==j?e+g.substring(h,j):e}var d=/["'&<>]/;a.exports=b},function(b,f,c){var a=c(9),d=c(7);b.exports=function(){var g=a.newEl("canvas"),e=null;return function(k){null==e&&(e=g.getContext("2d"));var h=d.canvasRatio(),j=k.root;g.width=h*j.properties.width,g.height=h*j.properties.height,e.textBaseline="middle";var t=j.children.holderBg,A=h*t.width,C=h*t.height,D=2,y=D/2;e.fillStyle=t.properties.fill,e.fillRect(0,0,A,C),t.properties.outline&&(e.strokeStyle=t.properties.outline.fill,e.lineWidth=t.properties.outline.width,e.moveTo(y,y),e.lineTo(A-y,y),e.lineTo(A-y,C-y),e.lineTo(y,C-y),e.lineTo(y,y),e.moveTo(0,y),e.lineTo(A,C-y),e.moveTo(0,C-y),e.lineTo(A,y),e.stroke());var q=j.children.holderTextGroup;e.font=q.properties.font.weight+" "+h*q.properties.font.size+q.properties.font.units+" "+q.properties.font.family+", monospace",e.fillStyle=q.properties.fill;for(var E in q.children){var B=q.children[E];for(var i in B.children){var z=B.children[i],w=h*(q.x+B.x+z.x),x=h*(q.y+B.y+z.y+q.properties.leading/2);e.fillText(z.properties.text,w,x)}}return g.toDataURL("image/png")}}()}])}),function(b,a){a&&(Holder=b.Holder)}(this,"undefined"!=typeof Meteor&&"undefined"!=typeof Package);